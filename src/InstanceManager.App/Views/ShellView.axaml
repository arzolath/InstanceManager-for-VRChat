<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:InstanceManager.App.ViewModels"
             x:Class="InstanceManager.App.Views.ShellView"
             x:DataType="vm:ShellViewModel">

  <UserControl.Styles>
    <Style Selector="ToggleButton.nav">
      <Setter Property="Width" Value="48" />
      <Setter Property="Height" Value="48" />
      <Setter Property="Padding" Value="0" />
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="BorderBrush" Value="Transparent" />
      <Setter Property="Foreground" Value="{StaticResource Color.TextMuted}" />
      <Setter Property="CornerRadius" Value="12" />
      <Setter Property="HorizontalContentAlignment" Value="Center" />
      <Setter Property="VerticalContentAlignment" Value="Center" />
    </Style>

    <Style Selector="ToggleButton.nav:pointerover">
      <Setter Property="Background" Value="#14283547" />
      <Setter Property="Foreground" Value="{StaticResource Color.Text}" />
    </Style>

    <Style Selector="ToggleButton.nav:checked">
      <Setter Property="Background" Value="{StaticResource Color.Accent}" />
      <Setter Property="Foreground" Value="White" />
    </Style>

    <Style Selector="Button.primary-pill">
      <Setter Property="Background" Value="{StaticResource Color.Accent}" />
      <Setter Property="Foreground" Value="White" />
      <Setter Property="BorderBrush" Value="{StaticResource Color.Accent}" />
      <Setter Property="CornerRadius" Value="16" />
      <Setter Property="Padding" Value="16,8" />
    </Style>
  </UserControl.Styles>

  <Grid ColumnDefinitions="76,*" RowDefinitions="Auto,*" Margin="18">

    <!-- Left rail -->
    <Border Grid.RowSpan="2"
            Background="{StaticResource Color.SurfaceAlt}"
            BorderBrush="{StaticResource Color.SubtleBorder}"
            BorderThickness="1"
            CornerRadius="12"
            Padding="14,18">
      <StackPanel Spacing="8" HorizontalAlignment="Center">
        <StackPanel Spacing="8">
          <ToggleButton Classes="nav"
                        IsChecked="{Binding IsDashboardActive}"
                        ToolTip.Tip="Profile"
                        Command="{Binding GoDashboardAsync}"
                        IsHitTestVisible="True">
            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE716;" FontSize="18" />
          </ToggleButton>
          <ToggleButton Classes="nav"
                        IsChecked="{Binding IsBlockListActive}"
                        ToolTip.Tip="Block List"
                        Command="{Binding GoBlockListsAsync}">
            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE71C;" FontSize="18" />
          </ToggleButton>
          <ToggleButton Classes="nav"
                        IsChecked="{Binding IsOwnedInstancesActive}"
                        ToolTip.Tip="Owned Instances"
                        Command="{Binding GoOwnedInstancesAsync}">
            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE81E;" FontSize="18" />
          </ToggleButton>
        </StackPanel>
      </StackPanel>
    </Border>

    <!-- Top bar -->
    <Grid Grid.Column="1" Grid.Row="0" ColumnDefinitions="*,Auto" Margin="16,0,0,14">
      <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
        <TextBlock Text="Instance Manager"
                   Classes="heading" />
        <Border Background="#143B82F6"
                BorderBrush="#263B82F6"
                BorderThickness="1"
                CornerRadius="10"
                Padding="10,6">
          <TextBlock Text="for VRChat" Foreground="{StaticResource Color.Accent}" />
        </Border>
      </StackPanel>

      <StackPanel Grid.Column="1"
                  Orientation="Horizontal"
                  Spacing="12"
                  VerticalAlignment="Center"
                  IsVisible="{Binding IsLoggedIn}">

        <Border Width="36"
                Height="36"
                CornerRadius="12"
                BorderBrush="{StaticResource Color.SubtleBorder}"
                BorderThickness="1"
                Background="{StaticResource Color.SurfaceAlt}">
          <Grid>
            <Image Source="{Binding AvatarUrl}" Stretch="UniformToFill" />
            <TextBlock Text="&#xE77B;"
                       FontFamily="Segoe MDL2 Assets"
                       Foreground="{StaticResource Color.TextMuted}"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Opacity="0.8"/>
          </Grid>
        </Border>

        <StackPanel>
          <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" />
          <TextBlock Text="Online" FontSize="{StaticResource Font.Size.Small}" Foreground="{StaticResource Color.Success}" />
        </StackPanel>

        <Button Classes="primary-pill"
                Content="Logout"
                Command="{Binding LogoutAsync}" />
      </StackPanel>
    </Grid>

    <!-- Main area -->
    <Grid Grid.Column="1" Grid.Row="1" RowDefinitions="*,Auto" Margin="16,0,0,0">
      <Border Classes="card" Padding="18">
        <ContentControl Content="{Binding Nav.CurrentViewModel}" />
      </Border>

      <Border Grid.Row="1"
              Margin="0,14,0,0"
              Padding="12"
              Classes="card">
        <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
          <Button Content="Open on GitHub"
                  Command="{Binding OpenGithub}" />
        </StackPanel>
      </Border>
    </Grid>

  </Grid>
</UserControl>
